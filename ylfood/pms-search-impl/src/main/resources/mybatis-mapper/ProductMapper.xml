<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.spfood.pms.search.intf.domain.Product">
	<resultMap id="BaseResultMap" type="com.spfood.pms.search.intf.domain.Product">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
	    <id column="id" property="id" jdbcType="BIGINT" />
	    <result column="product_code" property="productCode" jdbcType="VARCHAR" />
	    <result column="category_code" property="categoryCode" jdbcType="VARCHAR" />
	    <result column="product_gs1_code" property="productGs1Code" jdbcType="VARCHAR" />
	    <result column="product_name" property="productName" jdbcType="VARCHAR" />
	    <result column="product_buy_unit_name" property="productBuyUnitName" jdbcType="VARCHAR" />
	    <result column="product_buy_unit_code" property="productBuyUnitCode" jdbcType="VARCHAR" />
	    <result column="product_show_name" property="productShowName" jdbcType="VARCHAR" />
	    <result column="product_terminal" property="productTerminal" jdbcType="DECIMAL" />
	    <result column="product_status" property="productStatus" jdbcType="INTEGER" />
	    <result column="sale_flag" property="saleFlag" jdbcType="INTEGER" />
	    <result column="composite_flag" property="compositeFlag" jdbcType="INTEGER" />
	    <result column="product_specification_value" property="productSpecificationValue" jdbcType="FLOAT" />
	    <result column="product_specification_unit_first" property="productSpecificationUnitFirst" jdbcType="VARCHAR" />
	    <result column="product_specification_unit_second" property="productSpecificationUnitSecond" jdbcType="VARCHAR" />
		<result column="create_date" property="createDate" jdbcType="TIMESTAMP" />
		<result column="create_user" property="createUser" jdbcType="VARCHAR" />
		<result column="last_update_date" property="lastUpdateDate"
			jdbcType="TIMESTAMP" />
		<result column="last_update_user" property="lastUpdateUser"
			jdbcType="VARCHAR" />
		<collection property="productProperties"
			ofType="com.spfood.pms.search.intf.domain.ProductProperty" column="product_code">
			<id column="property_id" property="id" jdbcType="BIGINT" />
			<result column="property_product_code" property="productCode"
				jdbcType="VARCHAR" />
			<result column="product_property_name" property="productPropertyName"
				jdbcType="VARCHAR" />
			<result column="product_property_value" property="productPropertyValue"
				jdbcType="VARCHAR" />
			<result column="customer_define_flag" property="customerDefineFlag" jdbcType="INTEGER" />
		</collection>
	</resultMap>
	<sql id="Base_Column_List">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
    id, product_code, category_code, product_gs1_code, product_name, product_show_name,product_buy_unit_name,
    product_buy_unit_code, 
    product_terminal, product_status, sale_flag, composite_flag, product_specification_value, 
    product_specification_unit_first, product_specification_unit_second, create_date, 
    create_user, last_update_date, last_update_user
	</sql>
	<sql id="Casecade_Where_Case">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		<where>
			<if test="id != null">
				AND product.id = #{id,jdbcType=BIGINT}
			</if>
			<if test="productCode != null">
				AND product.product_code =
				#{productCode,jdbcType=VARCHAR}
			</if>
			<if test="categoryCode != null">
				AND category_code = #{categoryCode,jdbcType=VARCHAR}
			</if>
			<if test="productGs1Code != null">
				AND product_gs1_code = #{productGs1Code,jdbcType=VARCHAR}
			</if>
			<if test="productName != null">
				AND product_name = #{productName,jdbcType=VARCHAR}
			</if>
			<if test="productShowName != null">
				AND product_show_name =
				#{productShowName,jdbcType=VARCHAR}
			</if>
			<if test="productTerminal != null">
				AND product_terminal =
				#{productTerminal,jdbcType=DECIMAL}
			</if>
			<if test="productStatus != null">
				AND product_status = #{productStatus,jdbcType=INTEGER}
			</if>
			<if test="saleFlag != null">
				AND sale_flag = #{saleFlag,jdbcType=INTEGER}
			</if>
			<if test="compositeFlag != null">
				AND composite_flag = #{compositeFlag,jdbcType=INTEGER}
			</if>
			<if test="propertySearchCriteria != null">
			and property.product_property_name = #{propertySearchCriteria.productPropertyName}
			and	property.product_property_value= #{propertySearchCriteria.productPropertyValue}
		</if>
		</where>
	</sql>

	<sql id="Base_Where_Case" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <where >
      <if test="id != null" >
         AND id = #{id,jdbcType=BIGINT}
      </if>
      <if test="productCode != null" >
         AND product_code = #{productCode,jdbcType=VARCHAR}
      </if>
      <if test="categoryCode != null" >
         AND category_code = #{categoryCode,jdbcType=VARCHAR}
      </if>
      <if test="productGs1Code != null" >
         AND product_gs1_code = #{productGs1Code,jdbcType=VARCHAR}
      </if>
      <if test="productName != null" >
         AND product_name = #{productName,jdbcType=VARCHAR}
      </if>
      <if test="productShowName != null" >
         AND product_show_name = #{productShowName,jdbcType=VARCHAR}
      </if>
      <if test="productTerminal != null" >
         AND product_terminal = #{productTerminal,jdbcType=DECIMAL}
      </if>
      <if test="productStatus != null" >
         AND product_status = #{productStatus,jdbcType=INTEGER}
      </if>
      <if test="saleFlag != null" >
         AND sale_flag = #{saleFlag,jdbcType=INTEGER}
      </if>
      <if test="compositeFlag != null" >
         AND composite_flag = #{compositeFlag,jdbcType=INTEGER}
      </if>
      <if test="productSpecificationValue != null" >
         AND product_specification_value = #{productSpecificationValue,jdbcType=FLOAT}
      </if>
      <if test="productSpecificationUnitFirst != null" >
         AND product_specification_unit_first = #{productSpecificationUnitFirst,jdbcType=VARCHAR}
      </if>
      <if test="productSpecificationUnitSecond != null" >
         AND product_specification_unit_second = #{productSpecificationUnitSecond,jdbcType=VARCHAR}
      </if>
    </where>
  </sql>
  <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="com.spfood.pms.search.intf.domain.Product">
      
      select 
      <include refid="Base_Column_List" />
    from pms_product
    where id = #{id,jdbcType=BIGINT}
  </select>

	<!-- 分页查询基础信息开始 -->
	<select id="selectCount" resultType="java.lang.Long"
		parameterType="com.spfood.pms.search.intf.domain.Product">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		select count(DISTINCT product.id)
		from pms_product product
		left join
		pms_product_property property
		on product.product_code =
		property.product_code
		left join pms_product_category 
		on product.category_code = pms_product_category.category_code 
		where 1= 1
		<if test="categoryCode != null">
			and product.category_code = #{categoryCode,jdbcType=VARCHAR}
		</if>
		<if test="productCode != null">
			and product.product_code like #{productCode,jdbcType=VARCHAR}
		</if>
		<if test="productName != null">
			and product.product_name like #{productName,jdbcType=VARCHAR}
		</if>
		<if test="compositeFlag != null">
			and product.composite_flag = #{compositeFlag,jdbcType=VARCHAR}
		</if>
		<if test="saleFlag != null">
			and product.sale_flag = #{saleFlag,jdbcType=VARCHAR}
		</if>
		<if test="category != null and category.categoryName != null">
			and pms_product_category.category_name like #{category.categoryName,jdbcType=VARCHAR}
		</if>
		<if test="propertySearchCriteria != null">
			and property.product_property_name = #{propertySearchCriteria.productPropertyName}
			and	property.product_property_value= #{propertySearchCriteria.productPropertyValue}
		</if>
	</select>


	<select id="selectBase" resultType="com.spfood.pms.search.intf.domain.Product"
		parameterType="com.spfood.pms.search.intf.domain.Product">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		select DISTINCT product.id
		from pms_product product
		left join
		pms_product_property property
		on product.product_code = property.product_code
		left join pms_product_category 
		on product.category_code = pms_product_category.category_code 
		where 1=1 
		<if test="categoryCode != null">
			and product.category_code = #{categoryCode,jdbcType=VARCHAR}
		</if>
		<if test="productCode != null">
			and product.product_code like #{productCode,jdbcType=VARCHAR}
		</if>
		<if test="productBuyUnitCode == 'true'">
			and product.product_buy_unit_code is not null
		</if>
		<if test="productBuyUnitCode == 'false'">
			and product.product_buy_unit_code is null
		</if>
		<if test="productName != null">
			and product.product_name like #{productName,jdbcType=VARCHAR}
		</if>
		<if test="compositeFlag != null">
			and product.composite_flag = #{compositeFlag,jdbcType=VARCHAR}
		</if>
		<if test="saleFlag != null">
			and product.sale_flag = #{saleFlag,jdbcType=VARCHAR}
		</if>
		<if test="category != null and category.categoryName != null">
			and pms_product_category.category_name like #{category.categoryName,jdbcType=VARCHAR}
		</if>
		<if test="propertySearchCriteria != null">
			and property.product_property_name = #{propertySearchCriteria.productPropertyName}
			and	property.product_property_value= #{propertySearchCriteria.productPropertyValue}
		</if>
	</select>
	<!-- 分页查询基础信息结束 -->

	<select id="select" resultMap="BaseResultMap"
		parameterType="com.spfood.pms.search.intf.domain.Product">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		select product.*, product_property_name, product_property_value,
		property.id as property_id, property.product_code property_product_code,
		property.customer_define_flag 
		from pms_product
		product 
		left join 
		pms_product_property property
		on
		product.product_code =	property.product_code
		<include refid="Casecade_Where_Case" />
		order by product.create_date asc
	</select>

	<select id="selectListByIds" resultMap="BaseResultMap"
		parameterType="java.util.List">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		select product.*,
		product_property_name, product_property_value,product_buy_unit_name,product_buy_unit_code,
		property.id as property_id, property.product_code property_product_code,
		property.customer_define_flag
		from pms_product
		product
		<!-- LEFT JOIN pms_product_picture picture
		on product.product_code =
		picture.product_code
		-->
		left join
		pms_product_property property
		on
		product.product_code =
		property.product_code
		where product.id in

		<foreach item="item" index="index" collection="list" open="("
			separator="," close=")">
			#{item}
		</foreach>
		order by product.create_date asc
	</select>

	<insert id="insert" parameterType="com.spfood.pms.search.intf.domain.Product"
	        useGeneratedKeys="true" keyProperty="id">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
    insert into pms_product ( product_code, category_code, 
      product_gs1_code, product_name, product_show_name, 
      product_terminal, product_status, sale_flag, 
      composite_flag, product_specification_value, 
      product_specification_unit_first, product_specification_unit_second, 
      create_date, create_user, last_update_date, 
      last_update_user)
    values (#{productCode,jdbcType=VARCHAR}, #{categoryCode,jdbcType=VARCHAR}, 
      #{productGs1Code,jdbcType=VARCHAR}, #{productName,jdbcType=VARCHAR}, #{productShowName,jdbcType=VARCHAR}, 
      #{productTerminal,jdbcType=DECIMAL}, #{productStatus,jdbcType=INTEGER}, #{saleFlag,jdbcType=INTEGER}, 
      #{compositeFlag,jdbcType=INTEGER}, #{productSpecificationValue,jdbcType=FLOAT}, 
      #{productSpecificationUnitFirst,jdbcType=VARCHAR}, #{productSpecificationUnitSecond,jdbcType=VARCHAR}, 
      #{createDate,jdbcType=TIMESTAMP}, #{createUser,jdbcType=VARCHAR}, #{lastUpdateDate,jdbcType=TIMESTAMP}, 
      #{lastUpdateUser,jdbcType=VARCHAR})
	</insert>

</mapper>