<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.spfood.pms.intf.domain.ProductItem">
	<resultMap id="BaseResultMap" type="com.spfood.pms.intf.domain.ProductItem">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		<id column="composite_product_id" property="compositeProductId"
			jdbcType="BIGINT" />
		<id column="product_id" property="productId" jdbcType="BIGINT" />
		<result column="quantity" property="quantity" jdbcType="INTEGER" />

		<collection property="product" ofType="com.spfood.pms.intf.domain.Product"
			column="product_id">
			<id column="id" property="id" jdbcType="BIGINT" />
			<result column="product_code" property="productCode" jdbcType="VARCHAR" />
			<result column="category_code" property="categoryCode"
				jdbcType="VARCHAR" />
			<result column="product_gs1_code" property="productGs1Code"
				jdbcType="VARCHAR" />
			<result column="product_name" property="productName" jdbcType="VARCHAR" />
			<result column="product_show_name" property="productShowName"
				jdbcType="VARCHAR" />
			<result column="product_terminal" property="productTerminal"
				jdbcType="DECIMAL" />
			<result column="product_status" property="productStatus"
				jdbcType="INTEGER" />
			<result column="sale_flag" property="saleFlag" jdbcType="INTEGER" />
			<result column="composite_flag" property="compositeFlag"
				jdbcType="INTEGER" />
			<result column="product_specification_value" property="productSpecificationValue"
				jdbcType="FLOAT" />
			<result column="product_specification_unit_first" property="productSpecificationUnitFirst"
				jdbcType="VARCHAR" />
			<result column="product_specification_unit_second" property="productSpecificationUnitSecond"
				jdbcType="VARCHAR" />
			<result column="create_date" property="createDate" jdbcType="TIMESTAMP" />
			<result column="create_user" property="createUser" jdbcType="VARCHAR" />
			<result column="last_update_date" property="lastUpdateDate"
				jdbcType="TIMESTAMP" />
			
			<collection property="productProperties"
			ofType="com.spfood.pms.intf.domain.ProductProperty" column="product_code">
				<id column="property_id_id" property="id" jdbcType="BIGINT" />
				<result column="property_product_code" property="productCode"
					jdbcType="VARCHAR" />
				<result column="product_property_name" property="productPropertyName"
					jdbcType="VARCHAR" />
				<result column="product_property_value" property="productPropertyValue"
					jdbcType="VARCHAR" />
				<result column="customer_define_flag" property="customerDefineFlag" jdbcType="INTEGER" />
			</collection>
		</collection>
	</resultMap>
	<sql id="Base_Column_List">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		composite_product_id, product_id, quantity
	</sql>
	<sql id="Base_Where_Case">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		<where>
			<if test="compositeProductId != null">
				AND composite_product_id = #{compositeProductId,jdbcType=BIGINT}
			</if>
			<if test="productId != null">
				AND product_id = #{productId,jdbcType=BIGINT}
			</if>
			<if test="quantity != null">
				AND quantity = #{quantity,jdbcType=INTEGER}
			</if>
		</where>
	</sql>
	<select id="selectCount" resultType="java.lang.Long"
		parameterType="com.spfood.pms.intf.domain.ProductItem">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		select count( composite_product_id,product_id)
		from pms_product_item
		<include refid="Base_Where_Case" />
	</select>
	<select id="select" resultMap="BaseResultMap"
		parameterType="com.spfood.pms.intf.domain.ProductItem">
		select pms_product_item.*,pms_product.*,pms_product_property.id as property_id_id,pms_product_property.product_property_value
		FROM pms_product_item
		LEFT JOIN pms_product
		ON pms_product_item.product_id = pms_product.id
		left join pms_product_property on pms_product_property.product_code = pms_product.product_code
		<include refid="Base_Where_Case" />

	</select>

	<insert id="insert" parameterType="com.spfood.pms.intf.domain.ProductItem">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		insert into pms_product_item (composite_product_id, product_id,
		quantity
		)
		values (#{compositeProductId,jdbcType=BIGINT}, #{productId,jdbcType=BIGINT},
		#{quantity,jdbcType=INTEGER}
		)
	</insert>

	<delete id="delete" parameterType="com.spfood.pms.intf.domain.ProductItem">
		delete from pms_product_item
		<include refid="Base_Where_Case" />
	</delete>
</mapper>